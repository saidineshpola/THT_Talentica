2025-05-19T02:01:30.341Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T02:01:30.360Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T02:01:30.361Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
Installed 35 packages in 351ms
2025-05-19T02:01:40.068Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T02:01:40.069Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T02:01:40.109Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T02:01:40.109Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T02:01:40.109Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 07:31:40,106 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 07:31:40,106 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 07:31:40,106 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:01:40.113Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"parse_pdf_file","description":"\n    Parse a PDF file to extract and structure bill data.\n    \n    Args:\n        pdf_content: The binary content of the PDF file\n        filename: Name of the uploaded file\n        \n    Returns:\n        Structured bill data extracted from the PDF\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_fileArguments","type":"object"}},{"name":"parse_bill_image","description":"\n    Parse a bill image to extract and structure bill data.\n    \n    Args:\n        image_content: The binary content of the image file\n        filename: Name of the uploaded file\n        image_format: Format of the image (png, jpg, jpeg, etc.)\n        \n    Returns:\n        Structured bill data extracted from the image\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_bill_imageArguments","type":"object"}},{"name":"query_bill","description":"\n    Query information from a previously parsed bill.\n    \n    Args:\n        bill_id: The ID of the bill to query\n        question: The question to ask about the bill\n        \n    Returns:\n        An answer to the question based on the bill data\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_id","question"],"title":"query_billArguments","type":"object"}},{"name":"general_chat","description":"\n    Provide general conversation capability.\n    \n    Args:\n        user_message: The message from the user\n        \n    Returns:\n        A response to the user's message\n    ","inputSchema":{"properties":{"user_message":{"title":"User Message","type":"string"}},"required":["user_message"],"title":"general_chatArguments","type":"object"}},{"name":"export_bill_data","description":"\n    Save a parsed bill by its ID to a JSON file.\n    \n    Args:\n        bill_id: The ID of the bill to export\n        filename: Optional custom filename for the exported bill\n        \n    Returns:\n        Information about the exported bill file\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Filename"}},"required":["bill_id"],"title":"export_bill_dataArguments","type":"object"}},{"name":"get_bill_by_id","description":"\n    Retrieve a parsed bill by its ID.\n    \n    Args:\n        bill_id: The ID of the bill to retrieve\n        \n    Returns:\n        The bill data associated with the ID\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"}},"required":["bill_id"],"title":"get_bill_by_idArguments","type":"object"}},{"name":"list_all_bills","description":"\n    List all parsed bills currently in memory.\n    \n    Returns:\n        A list of all stored bill data\n    ","inputSchema":{"properties":{},"title":"list_all_billsArguments","type":"object"}}]}}
2025-05-19T02:01:40.114Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"parse_pdf_file","description":"\n    Parse a PDF file to extract and structure bill data.\n    \n    Args:\n        pdf_content: The binary content of the PDF file\n        filename: Name of the uploaded file\n        \n    Returns:\n        Structured bill data extracted from the PDF\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_fileArguments","type":"object"}},{"name":"parse_bill_image","description":"\n    Parse a bill image to extract and structure bill data.\n    \n    Args:\n        image_content: The binary content of the image file\n        filename: Name of the uploaded file\n        image_format: Format of the image (png, jpg, jpeg, etc.)\n        \n    Returns:\n        Structured bill data extracted from the image\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_bill_imageArguments","type":"object"}},{"name":"query_bill","description":"\n    Query information from a previously parsed bill.\n    \n    Args:\n        bill_id: The ID of the bill to query\n        question: The question to ask about the bill\n        \n    Returns:\n        An answer to the question based on the bill data\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_id","question"],"title":"query_billArguments","type":"object"}},{"name":"general_chat","description":"\n    Provide general conversation capability.\n    \n    Args:\n        user_message: The message from the user\n        \n    Returns:\n        A response to the user's message\n    ","inputSchema":{"properties":{"user_message":{"title":"User Message","type":"string"}},"required":["user_message"],"title":"general_chatArguments","type":"object"}},{"name":"export_bill_data","description":"\n    Save a parsed bill by its ID to a JSON file.\n    \n    Args:\n        bill_id: The ID of the bill to export\n        filename: Optional custom filename for the exported bill\n        \n    Returns:\n        Information about the exported bill file\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Filename"}},"required":["bill_id"],"title":"export_bill_dataArguments","type":"object"}},{"name":"get_bill_by_id","description":"\n    Retrieve a parsed bill by its ID.\n    \n    Args:\n        bill_id: The ID of the bill to retrieve\n        \n    Returns:\n        The bill data associated with the ID\n    ","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"}},"required":["bill_id"],"title":"get_bill_by_idArguments","type":"object"}},{"name":"list_all_bills","description":"\n    List all parsed bills currently in memory.\n    \n    Returns:\n        A list of all stored bill data\n    ","inputSchema":{"properties":{},"title":"list_all_billsArguments","type":"object"}}]}}
2025-05-19T02:01:40.115Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T02:01:40.127Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 07:31:40,122 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:01:40.130Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T02:02:11.776Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"list_all_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 07:32:11,777 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 07:32:11,778 - document_management.api - INFO - Listing all bills
2025-05-19T02:02:11.779Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[],"isError":false}}
2025-05-19T02:11:40.369Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":6}
2025-05-19 07:41:40,371 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:11:40.372Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"resources":[]}}
2025-05-19T02:11:40.372Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":7}
2025-05-19 07:41:40,371 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:11:40.374Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"prompts":[]}}
2025-05-19T02:21:40.362Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":8}
2025-05-19 07:51:40,362 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:21:40.364Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":8,"result":{"resources":[]}}
2025-05-19T02:21:40.364Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":9}
2025-05-19 07:51:40,362 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:21:40.366Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":9,"result":{"prompts":[]}}
2025-05-19T02:31:40.359Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":10}
2025-05-19 08:01:40,360 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:31:40.362Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":10,"result":{"resources":[]}}
2025-05-19T02:31:40.363Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":11}
2025-05-19 08:01:40,360 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:31:40.364Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":11,"result":{"prompts":[]}}
2025-05-19T02:41:40.362Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":12}
2025-05-19 08:11:40,364 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:41:40.365Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":12,"result":{"resources":[]}}
2025-05-19T02:41:40.366Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":13}
2025-05-19 08:11:40,367 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:41:40.367Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":13,"result":{"prompts":[]}}
2025-05-19T02:51:40.363Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":14}
2025-05-19 08:21:40,364 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:51:40.365Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":14,"result":{"resources":[]}}
2025-05-19T02:51:40.366Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":15}
2025-05-19 08:21:40,367 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:51:40.367Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":15,"result":{"prompts":[]}}
2025-05-19T02:57:44.599Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T02:57:44.617Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T02:57:44.670Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19T02:57:53.420Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T02:57:53.421Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T02:57:53.431Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T02:57:53.431Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T02:57:53.431Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 08:27:53,430 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:27:53,430 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:27:53,430 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T02:57:53.434Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"parse_pdf_file","description":"Parse a PDF file to extract and structure bill data.","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_fileArguments","type":"object"}},{"name":"parse_bill_image","description":"Parse a bill image to extract and structure bill data.","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_bill_imageArguments","type":"object"}},{"name":"chat","description":"Handle general conversation with the user.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"chatArguments","type":"object"}},{"name":"export_bill","description":"Export a bill's data to JSON file.","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Filename"}},"required":["bill_id"],"title":"export_billArguments","type":"object"}}]}}
2025-05-19T02:57:53.435Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"parse_pdf_file","description":"Parse a PDF file to extract and structure bill data.","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_fileArguments","type":"object"}},{"name":"parse_bill_image","description":"Parse a bill image to extract and structure bill data.","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_bill_imageArguments","type":"object"}},{"name":"chat","description":"Handle general conversation with the user.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"chatArguments","type":"object"}},{"name":"export_bill","description":"Export a bill's data to JSON file.","inputSchema":{"properties":{"bill_id":{"title":"Bill Id","type":"string"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Filename"}},"required":["bill_id"],"title":"export_billArguments","type":"object"}}]}}
2025-05-19T02:57:53.435Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[{"uri":"bills://list","name":"list_bills","description":"List all available bills","mimeType":"text/plain"}]}}
2025-05-19T02:57:53.443Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 08:27:53,444 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T02:57:53.445Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T03:07:54.356Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":5}
2025-05-19 08:37:54,357 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:07:54.359Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"resources":[{"uri":"bills://list","name":"list_bills","description":"List all available bills","mimeType":"text/plain"}]}}
2025-05-19T03:07:54.360Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":6}
2025-05-19 08:37:54,361 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:07:54.361Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"prompts":[]}}
2025-05-19T03:10:58.911Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T03:10:58.935Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T03:10:58.986Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19T03:11:01.291Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T03:11:01.291Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T03:11:01.302Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T03:11:01.302Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T03:11:01.302Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 08:41:01,302 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:41:01,303 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:41:01,304 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:11:01.305Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"list_processed_bills","description":"\n    List all processed bills, showing their internal ID and original filename.\n    This is the first step for the user to see available documents.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    Parse a PDF file to extract bill data, store it, and save the PDF.\n    The 'filename' argument should be the original name of the PDF file.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    Parse an image file (e.g., PNG, JPG) to extract bill data, store it, and save the image.\n    The 'filename' argument should be the original name of the image file.\n    'image_format' should be the extension like 'png', 'jpeg', 'tiff'.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename).\n    The question and answer will be saved to the bill's data and JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in an 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:11:01.305Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"list_processed_bills","description":"\n    List all processed bills, showing their internal ID and original filename.\n    This is the first step for the user to see available documents.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    Parse a PDF file to extract bill data, store it, and save the PDF.\n    The 'filename' argument should be the original name of the PDF file.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    Parse an image file (e.g., PNG, JPG) to extract bill data, store it, and save the image.\n    The 'filename' argument should be the original name of the image file.\n    'image_format' should be the extension like 'png', 'jpeg', 'tiff'.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename).\n    The question and answer will be saved to the bill's data and JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in an 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:11:01.306Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T03:11:01.314Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 08:41:01,315 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:11:01.316Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T03:11:24.229Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"list_processed_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 08:41:24,230 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 08:41:24,231 - document_management.api - INFO - Listing all processed bills.
2025-05-19T03:11:24.232Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"message\": \"No bills processed yet.\"\n}"}],"isError":false}}
2025-05-19T03:21:01.357Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":6}
2025-05-19 08:51:01,358 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:21:01.359Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"resources":[]}}
2025-05-19T03:21:01.360Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":7}
2025-05-19 08:51:01,361 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:21:01.368Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"prompts":[]}}
2025-05-19T03:23:13.107Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T03:23:13.126Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T03:23:13.174Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 08:53:15,548 - document_management.api - INFO - Standard directories ensured. Uploads expected in: assets\bills\uploads
2025-05-19T03:23:15.575Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T03:23:15.575Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T03:23:15.587Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T03:23:15.588Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T03:23:15.588Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 08:53:15,588 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:53:15,590 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:53:15,590 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:23:15.591Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:23:15.592Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:23:15.592Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T03:23:15.602Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 08:53:15,603 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:23:15.604Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T03:24:53.276Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 08:54:53,276 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 08:54:53,277 - document_management.api - INFO - Scanning for bills in: assets\bills\uploads
2025-05-19T03:24:53.279Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"message\": \"No bill files found in the uploads directory.\"\n}"}],"isError":false}}
2025-05-19T03:26:05.131Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":6}
2025-05-19 08:56:05,132 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 08:56:05,133 - document_management.api - INFO - Scanning for bills in: assets\bills\uploads
2025-05-19T03:26:05.134Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\n  \"message\": \"No bill files found in the uploads directory.\"\n}"}],"isError":false}}
2025-05-19T03:28:24.547Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T03:28:24.566Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T03:28:24.685Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 08:58:26,481 - document_management.api - INFO - Standard directories ensured. Uploads expected in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19T03:28:26.504Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T03:28:26.505Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T03:28:26.506Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T03:28:26.507Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T03:28:26.507Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 08:58:26,505 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:58:26,505 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 08:58:26,505 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:28:26.509Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:28:26.510Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:28:26.510Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T03:28:26.513Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 08:58:26,515 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:28:26.515Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T03:28:38.988Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 08:58:38,989 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 08:58:38,990 - document_management.api - INFO - Scanning for bills in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19 08:58:38,990 - document_management.api - INFO - Found 3 potential bill files in C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19T03:28:38.992Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"filename\": \"Amazonbill.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Amazonbill.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Invoice.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Invoice.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Takeout.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Takeout.pdf\",\n  \"status\": \"\"\n}"}],"isError":false}}
2025-05-19T03:28:50.477Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"process_selected_bill_and_ask","arguments":{"original_filename":"Amazonbill.pdf","question":"What is the total amount billed?"}},"jsonrpc":"2.0","id":6}
2025-05-19 08:58:50,478 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 08:58:50,478 - document_management.api - INFO - Request to process 'Amazonbill.pdf' from uploads and answer question: 'What is the total amount billed?'
2025-05-19 08:58:50,478 - document_management.api - INFO - Bill 'Amazonbill.pdf' not found in memory. Attempting to load and process from C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19 08:58:50,479 - document_management.api - INFO - Internal processing for PDF (original: 'Amazonbill.pdf'), size: 306190 bytes
2025-05-19 08:58:50,480 - document_management.api - INFO - Copy of PDF 'Amazonbill.pdf' saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\pdfs\Amazonbill.pdf
2025-05-19 08:58:50,571 - document_management.api - INFO - Extracted raw text length from PDF: 1842
2025-05-19 08:58:58,621 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 08:58:58,640 - document_management.api - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19 08:58:58,640 - document_management.api - INFO - Successfully parsed and stored PDF as bill ID: bill_1 (from original file: Amazonbill.pdf)
2025-05-19 08:58:58,640 - document_management.api - INFO - Newly processed 'Amazonbill.pdf' assigned bill ID: bill_1
2025-05-19 08:58:58,640 - document_management.api - INFO - Proceeding to answer question for bill 'Amazonbill.pdf' (ID: bill_1).
2025-05-19 08:58:58,640 - document_management.api - INFO - Received question: 'What is the total amount billed?' for bill identifier: 'bill_1'
2025-05-19 08:58:59,386 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 08:58:59,388 - document_management.api - INFO - LLM generated answer for bill bill_1: 'The total amount billed is 1195.00.'
2025-05-19 08:58:59,389 - document_management.api - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T03:28:59.390Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"The total amount billed is 1195.00.\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T03:38:27.362Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":7}
2025-05-19 09:08:27,363 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:38:27.365Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"resources":[]}}
2025-05-19T03:38:27.365Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":8}
2025-05-19 09:08:27,366 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:38:27.367Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":8,"result":{"prompts":[]}}
2025-05-19T03:44:27.550Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T03:44:27.572Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T03:44:27.623Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 09:14:30,246 - document_management.api - INFO - Standard directories ensured. Uploads expected in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19T03:44:30.273Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T03:44:30.273Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T03:44:30.285Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T03:44:30.286Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T03:44:30.286Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 09:14:30,286 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 09:14:30,287 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 09:14:30,288 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:44:30.289Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:44:30.290Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T03:44:30.290Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T03:44:30.298Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 09:14:30,299 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:44:30.301Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T03:44:56.562Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 09:14:56,563 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 09:14:56,563 - document_management.api - INFO - Scanning for bills in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19 09:14:56,564 - document_management.api - INFO - Found 3 potential bill files in C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19T03:44:56.566Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"filename\": \"Amazonbill.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Amazonbill.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Invoice.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Invoice.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Takeout.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Takeout.pdf\",\n  \"status\": \"\"\n}"}],"isError":false}}
2025-05-19T03:45:04.030Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"process_selected_bill_and_ask","arguments":{"original_filename":"Amazonbill.pdf","question":"What is the total amount billed?"}},"jsonrpc":"2.0","id":6}
2025-05-19 09:15:04,031 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 09:15:04,031 - document_management.api - INFO - Request to process 'Amazonbill.pdf' from uploads and answer question: 'What is the total amount billed?'
2025-05-19 09:15:04,031 - document_management.api - INFO - Bill 'Amazonbill.pdf' not found in memory. Attempting to load and process from C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19 09:15:04,032 - document_management.api - INFO - Internal processing for PDF (original: 'Amazonbill.pdf'), size: 306190 bytes
2025-05-19 09:15:04,032 - document_management.api - INFO - Copy of PDF 'Amazonbill.pdf' saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\pdfs\Amazonbill.pdf
2025-05-19 09:15:04,043 - document_management.api - INFO - Extracted raw text length from PDF using pymupdf: 1842
2025-05-19 09:15:10,258 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 09:15:10,262 - document_management.api - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19 09:15:10,262 - document_management.api - INFO - Successfully parsed and stored PDF as bill ID: bill_1 (from original file: Amazonbill.pdf)
2025-05-19 09:15:10,262 - document_management.api - INFO - Newly processed 'Amazonbill.pdf' assigned bill ID: bill_1
2025-05-19 09:15:10,263 - document_management.api - INFO - Proceeding to answer question for bill 'Amazonbill.pdf' (ID: bill_1).
2025-05-19 09:15:10,263 - document_management.api - INFO - Received question: 'What is the total amount billed?' for bill identifier: 'bill_1'
2025-05-19 09:15:11,006 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
--- Logging error ---
Traceback (most recent call last):
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\logging\__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\u20b9' in position 125: character maps to <undefined>
Call stack:
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\Scripts\mcp.exe\__main__.py", line 10, in <module>
    sys.exit(app())
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\main.py", line 323, in __call__
    return get_command(self)(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\core.py", line 740, in main
    return _main(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\core.py", line 195, in _main
    rv = self.invoke(ctx)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 788, in invoke
    return __callback(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\main.py", line 698, in wrapper
    return callback(**use_params)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\cli\cli.py", line 362, in run
    server.run(**kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\server.py", line 232, in run
    anyio.run(self.run_stdio_async)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_core\_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_backends\_asyncio.py", line 2310, in run
    return runner.run(wrapper())
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_backends\_asyncio.py", line 217, in run
    return self._loop.run_until_complete(task)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 603, in run_forever
    self._run_once()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 534, in _handle_message
    await self._handle_request(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 568, in _handle_request
    response = await handler(req)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 412, in handler
    results = await func(req.params.name, (req.params.arguments or {}))
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\server.py", line 277, in call_tool
    result = await self._tool_manager.call_tool(name, arguments, context=context)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\tools\tool_manager.py", line 64, in call_tool
    return await tool.run(arguments, context=context)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\tools\base.py", line 91, in run
    return await self.fn_metadata.call_fn_with_arg_validation(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\utilities\func_metadata.py", line 66, in call_fn_with_arg_validation
    return await fn(**arguments_parsed_dict)
  File "C:\Users\user\Desktop\projects\THT_Talentica\server.py", line 393, in process_selected_bill_and_ask
    return await ask_question_and_save(bill_identifier=bill.id, question=question)
  File "C:\Users\user\Desktop\projects\THT_Talentica\server.py", line 495, in ask_question_and_save
    logger.info(f"LLM generated answer for bill {bill.id}: '{answer}'")
Message: "LLM generated answer for bill bill_1: 'The total amount billed is \u20b91,195.00.'"
Arguments: ()
2025-05-19 09:15:11,018 - document_management.api - INFO - LLM generated answer for bill bill_1: 'The total amount billed is \u20b91,195.00.'
2025-05-19 09:15:11,029 - document_management.api - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T03:45:11.031Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"The total amount billed is 1,195.00.\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T03:54:30.362Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":7}
2025-05-19 09:24:30,364 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T03:54:30.365Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"resources":[]}}
2025-05-19T03:54:30.366Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":8}
2025-05-19 09:24:30,367 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T03:54:30.367Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":8,"result":{"prompts":[]}}
2025-05-19T03:58:22.564Z [Bill Processing MCP] [info] Server transport closed
2025-05-19T03:58:22.567Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T03:58:22.571Z [Bill Processing MCP] [info] Server transport closed unexpectedly, this is likely due to the process exiting early. If you are developing this MCP server you can add output to stderr (i.e. `console.error('...')` in JavaScript, `print('...', file=sys.stderr)` in python) and it will appear in this log.
2025-05-19T03:58:22.573Z [Bill Processing MCP] [error] Server disconnected. For troubleshooting guidance, please visit our [debugging documentation](https://modelcontextprotocol.io/docs/tools/debugging) {"context":"connection"}
2025-05-19T03:58:22.577Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T09:00:29.201Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T09:00:29.272Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T09:00:29.301Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
Failed to run server: name 'Optional' is not defined
2025-05-19T09:00:41.469Z [Bill Processing MCP] [info] Server transport closed
2025-05-19T09:00:41.469Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T09:00:41.470Z [Bill Processing MCP] [info] Server transport closed unexpectedly, this is likely due to the process exiting early. If you are developing this MCP server you can add output to stderr (i.e. `console.error('...')` in JavaScript, `print('...', file=sys.stderr)` in python) and it will appear in this log.
2025-05-19T09:00:41.470Z [Bill Processing MCP] [error] Server disconnected. For troubleshooting guidance, please visit our [debugging documentation](https://modelcontextprotocol.io/docs/tools/debugging) {"context":"connection"}
2025-05-19T09:00:41.470Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T09:10:22.741Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T09:10:22.763Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T09:10:22.769Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 14:40:25,361 - document_management.text_extractors - INFO - Standard directories ensured. Uploads expected in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19T09:10:25.415Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T09:10:25.415Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T09:10:25.426Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T09:10:25.426Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T09:10:25.427Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 14:40:25,427 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 14:40:25,428 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 14:40:25,429 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:10:25.430Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T09:10:25.430Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T09:10:25.431Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T09:10:25.439Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 14:40:25,439 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:10:25.441Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T09:10:41.116Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 14:40:41,117 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:40:41,118 - document_management.api - INFO - Scanning for bills in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19 14:40:41,118 - document_management.api - INFO - Found 3 potential bill files in C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19T09:10:41.132Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"filename\": \"Amazonbill.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Amazonbill.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Invoice.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Invoice.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Takeout.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Takeout.pdf\",\n  \"status\": \"\"\n}"}],"isError":false}}
2025-05-19T09:10:50.074Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"process_selected_bill_and_ask","arguments":{"original_filename":"Amazonbill.pdf","question":"What is the total amount billed?"}},"jsonrpc":"2.0","id":6}
2025-05-19 14:40:50,074 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:40:50,075 - document_management.api - INFO - Request to process 'Amazonbill.pdf' from uploads and answer question: 'What is the total amount billed?'
2025-05-19T09:10:50.076Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"Error executing tool process_selected_bill_and_ask: local variable 'app_state' referenced before assignment"}],"isError":true}}
2025-05-19T09:11:18.328Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"parse_pdf_bill","arguments":{"filename":"Amazonbill.pdf","pdf_content":"UEsDBBQABgAIAAAAIQCCiqGJ9gAAAOEBAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC0lE1Pg0AQhu8m/gdyz7JVE2PYclATvdUmpu3RbIEJu9l2E/HnO0iBtjUQE+LlwH7MzPvM7EIvVo2kL7CuMDqjcS+iBHRutNJFRp/Wt4MzSl5wrbg0GjK6BkcvsvOTs6HVlSZvHBzwCeoz2uTcnnPu8gYUdz1jQfNG28T3V69L1WnOGW9+4HIWRkN+dGTiRjfojwMnfK4WHpYZvTvvzUXmLYxNHbU2cZ9FExJlDW8VRwPYcf4OqKV9lJK2PHR8/EEZ+hLkokXu"}},"jsonrpc":"2.0","id":7}
2025-05-19 14:41:18,329 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:41:18,329 - document_management.api - INFO - Direct PDF content parsing requested for filename: Amazonbill.pdf
2025-05-19 14:41:18,329 - document_management.api - ERROR - Direct PDF parsing tool failed for 'Amazonbill.pdf': local variable 'app_state' referenced before assignment
Traceback (most recent call last):
  File "C:\Users\user\Desktop\projects\THT_Talentica\server.py", line 183, in parse_pdf_bill
    app_state=app_state,
UnboundLocalError: local variable 'app_state' referenced before assignment
2025-05-19T09:11:18.332Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"content":[{"type":"text","text":"Error executing tool parse_pdf_bill: PDF processing from content failed for 'Amazonbill.pdf': local variable 'app_state' referenced before assignment"}],"isError":true}}
2025-05-19T09:14:01.042Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T09:14:01.064Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T09:14:01.069Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 14:44:03,698 - document_management.text_extractors - INFO - Standard directories ensured. Uploads expected in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19T09:14:03.722Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T09:14:03.723Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T09:14:03.733Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T09:14:03.733Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T09:14:03.733Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 14:44:03,734 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 14:44:03,735 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 14:44:03,736 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:14:03.737Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T09:14:03.737Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T09:14:03.738Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T09:14:03.745Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 14:44:03,746 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:14:03.747Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T09:14:18.437Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 14:44:18,438 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:44:18,438 - document_management.api - INFO - Scanning for bills in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19 14:44:18,439 - document_management.api - INFO - Found 3 potential bill files in C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19T09:14:18.440Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"filename\": \"Amazonbill.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Amazonbill.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Invoice.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Invoice.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Takeout.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Takeout.pdf\",\n  \"status\": \"\"\n}"}],"isError":false}}
2025-05-19T09:14:27.749Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"process_selected_bill_and_ask","arguments":{"original_filename":"Amazonbill.pdf","question":"What is the total amount billed?"}},"jsonrpc":"2.0","id":6}
2025-05-19 14:44:27,750 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:44:27,750 - document_management.api - INFO - Request to process 'Amazonbill.pdf' from uploads and answer question: 'What is the total amount billed?'
2025-05-19 14:44:27,750 - document_management.api - INFO - Bill 'Amazonbill.pdf' not found in memory. Attempting to load and process from C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19 14:44:27,763 - document_management.text_extractors - INFO - Internal processing for PDF (original: 'Amazonbill.pdf'), size: 306190 bytes
2025-05-19 14:44:27,763 - document_management.text_extractors - INFO - Copy of PDF 'Amazonbill.pdf' saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\pdfs\Amazonbill.pdf
2025-05-19 14:44:27,823 - document_management.text_extractors - INFO - Extracted raw text length from PDF using pymupdf: 1842
2025-05-19 14:44:38,109 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:44:38,122 - document_management.text_extractors - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19 14:44:38,122 - document_management.text_extractors - INFO - Successfully parsed and stored PDF as bill ID: bill_1 (from original file: Amazonbill.pdf)
2025-05-19 14:44:38,122 - document_management.api - INFO - Newly processed 'Amazonbill.pdf' assigned bill ID: bill_1
2025-05-19 14:44:38,122 - document_management.api - INFO - Proceeding to answer question for bill 'Amazonbill.pdf' (ID: bill_1).
2025-05-19 14:44:38,122 - document_management.api - INFO - Received question: 'What is the total amount billed?' for bill identifier: 'bill_1'
2025-05-19 14:44:39,121 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:44:39,122 - document_management.api - INFO - LLM generated answer for bill bill_1: 'The total amount billed is 1,195.00.'
2025-05-19 14:44:39,123 - document_management.text_extractors - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T09:14:39.125Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"The total amount billed is 1,195.00.\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T09:23:27.632Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"ask_question_and_save","arguments":{"bill_identifier":"bill_1","question":"What are the full details of this Amazon bill including invoice number, date, items purchased, prices, and any other relevant information?"}},"jsonrpc":"2.0","id":7}
2025-05-19 14:53:27,634 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 14:53:27,634 - document_management.api - INFO - Received question: 'What are the full details of this Amazon bill including invoice number, date, items purchased, prices, and any other relevant information?' for bill identifier: 'bill_1'
2025-05-19 14:53:50,632 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:53:50,640 - document_management.api - INFO - LLM generated answer for bill bill_1: 'Here are the full details of the Amazon bill:

- **Sold By:** Varasiddhi Silk Exports
- **Address:** 75, 3rd Cross, Lalbagh Road, BENGALURU, KARNATAKA, 560027, IN
- **PAN No:** AACFV3325K
- **GST Registration No:** 29AACFV3325K1ZY

- **Billing Address:** 
  Madhu B  
  Eurofins IT Solutions India Pvt Ltd  
  1st Floor, Maruti Platinum, Lakshminarayana Pura, AECS,  
  BENGALURU, KARNATAKA, 560037, IN  
  **State/UT Code:** 29

- **Shipping Address:** 
  Madhu B  
  Eurofins IT Solutions India Pvt Ltd  
  1st Floor, Maruti Platinum, Lakshminarayana Pura, AECS,  
  BENGALURU, KARNATAKA, 560037, IN  

- **Order Number:** 403-3225714-7676307
- **Order Date:** 28.10.2019
- **Place of Supply:** KARNATAKA
- **Place of Delivery:** KARNATAKA

- **Invoice Number:** IN-761
- **Invoice Date:** 28.10.2019
- **Invoice Details:** KA-310565025-1920

### Items Purchased:
1. **Varasiddhi Silks Men's Formal Shirt (SH-05-42, Navy Blue, 42)**  
   - **Unit Price:** 538.10  
   - **Quantity:** 1  
   - **Net Amount:** 3538.10  
   - **Tax:**  
     - 2.5% CGST: 13.45  
     - 2.5% SGST: 13.45  
   - **Total Amount:** 565.00  

2. **Varasiddhi Silks Men's Formal Shirt (SH-05-40, Navy Blue, 40)**  
   - **Unit Price:** 538.10  
   - **Quantity:** 1  
   - **Net Amount:** 538.10  
   - **Tax:**  
     - 2.5% CGST: 13.45  
     - 2.5% SGST: 13.45  
   - **Total Amount:** 565.00  

3. **Shipping Charges**  
   - **Price:** 30.96  
   - **Tax:**  
     - 2.5% CGST: 30.77  
     - 2.5% SGST: 30.77  
   - **Total Amount:** 32.50  

4. **Shipping Charges**  
   - **Price:** 30.96  
   - **Tax:**  
     - 2.5% CGST: 0.77  
     - 2.5% SGST: 0.77  
   - **Total Amount:** 32.50  

### Summary:
- **Total Amount (including GST):** 1195.00  
- **Total GST Amount:** 56.88  
- **Amount in Words:** One Thousand One Hundred And Ninety-five only  
- **Reverse Charge Applicable:** No  

**Authorized Signatory for Varasiddhi Silk Exports.**'
2025-05-19 14:53:50,641 - document_management.text_extractors - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T09:23:50.644Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"Here are the full details of the Amazon bill:\\n\\n- **Sold By:** Varasiddhi Silk Exports\\n- **Address:** 75, 3rd Cross, Lalbagh Road, BENGALURU, KARNATAKA, 560027, IN\\n- **PAN No:** AACFV3325K\\n- **GST Registration No:** 29AACFV3325K1ZY\\n\\n- **Billing Address:** \\n  Madhu B  \\n  Eurofins IT Solutions India Pvt Ltd  \\n  1st Floor, Maruti Platinum, Lakshminarayana Pura, AECS,  \\n  BENGALURU, KARNATAKA, 560037, IN  \\n  **State/UT Code:** 29\\n\\n- **Shipping Address:** \\n  Madhu B  \\n  Eurofins IT Solutions India Pvt Ltd  \\n  1st Floor, Maruti Platinum, Lakshminarayana Pura, AECS,  \\n  BENGALURU, KARNATAKA, 560037, IN  \\n\\n- **Order Number:** 403-3225714-7676307\\n- **Order Date:** 28.10.2019\\n- **Place of Supply:** KARNATAKA\\n- **Place of Delivery:** KARNATAKA\\n\\n- **Invoice Number:** IN-761\\n- **Invoice Date:** 28.10.2019\\n- **Invoice Details:** KA-310565025-1920\\n\\n### Items Purchased:\\n1. **Varasiddhi Silks Men's Formal Shirt (SH-05-42, Navy Blue, 42)**  \\n   - **Unit Price:** 538.10  \\n   - **Quantity:** 1  \\n   - **Net Amount:** 3538.10  \\n   - **Tax:**  \\n     - 2.5% CGST: 13.45  \\n     - 2.5% SGST: 13.45  \\n   - **Total Amount:** 565.00  \\n\\n2. **Varasiddhi Silks Men's Formal Shirt (SH-05-40, Navy Blue, 40)**  \\n   - **Unit Price:** 538.10  \\n   - **Quantity:** 1  \\n   - **Net Amount:** 538.10  \\n   - **Tax:**  \\n     - 2.5% CGST: 13.45  \\n     - 2.5% SGST: 13.45  \\n   - **Total Amount:** 565.00  \\n\\n3. **Shipping Charges**  \\n   - **Price:** 30.96  \\n   - **Tax:**  \\n     - 2.5% CGST: 30.77  \\n     - 2.5% SGST: 30.77  \\n   - **Total Amount:** 32.50  \\n\\n4. **Shipping Charges**  \\n   - **Price:** 30.96  \\n   - **Tax:**  \\n     - 2.5% CGST: 0.77  \\n     - 2.5% SGST: 0.77  \\n   - **Total Amount:** 32.50  \\n\\n### Summary:\\n- **Total Amount (including GST):** 1195.00  \\n- **Total GST Amount:** 56.88  \\n- **Amount in Words:** One Thousand One Hundred And Ninety-five only  \\n- **Reverse Charge Applicable:** No  \\n\\n**Authorized Signatory for Varasiddhi Silk Exports.**\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T09:24:03.746Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":8}
2025-05-19 14:54:03,748 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:24:03.749Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":8,"result":{"resources":[]}}
2025-05-19T09:24:03.750Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":9}
2025-05-19 14:54:03,751 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:24:03.752Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":9,"result":{"prompts":[]}}
2025-05-19T09:34:03.740Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":10}
2025-05-19 15:04:03,742 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:34:03.742Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":10,"result":{"resources":[]}}
2025-05-19T09:34:03.743Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":11}
2025-05-19 15:04:03,744 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:34:03.744Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":11,"result":{"prompts":[]}}
2025-05-19T09:44:03.733Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":12}
2025-05-19 15:14:03,735 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:44:03.736Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":12,"result":{"resources":[]}}
2025-05-19T09:44:03.737Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":13}
2025-05-19 15:14:03,738 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:44:03.738Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":13,"result":{"prompts":[]}}
2025-05-19T09:54:03.737Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":14}
2025-05-19 15:24:03,738 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T09:54:03.740Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":14,"result":{"resources":[]}}
2025-05-19T09:54:03.741Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":15}
2025-05-19 15:24:03,741 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T09:54:03.743Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":15,"result":{"prompts":[]}}
2025-05-19T09:58:06.774Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T09:58:06.794Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T09:58:06.865Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
Failed to run server: f-string expression part cannot include '#' (utils.py, line 391)
2025-05-19T09:58:08.954Z [Bill Processing MCP] [info] Server transport closed
2025-05-19T09:58:08.954Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T09:58:08.955Z [Bill Processing MCP] [info] Server transport closed unexpectedly, this is likely due to the process exiting early. If you are developing this MCP server you can add output to stderr (i.e. `console.error('...')` in JavaScript, `print('...', file=sys.stderr)` in python) and it will appear in this log.
2025-05-19T09:58:08.955Z [Bill Processing MCP] [error] Server disconnected. For troubleshooting guidance, please visit our [debugging documentation](https://modelcontextprotocol.io/docs/tools/debugging) {"context":"connection"}
2025-05-19T09:58:08.956Z [Bill Processing MCP] [info] Client transport closed
2025-05-19T10:00:14.637Z [Bill Processing MCP] [info] Initializing server...
2025-05-19T10:00:14.665Z [Bill Processing MCP] [info] Server started and connected successfully
2025-05-19T10:00:14.667Z [Bill Processing MCP] [info] Message from client: {"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"claude-ai","version":"0.1.0"}},"jsonrpc":"2.0","id":0}
2025-05-19 15:30:16,919 - document_management.utils - INFO - Standard directories ensured. Uploads expected in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19T10:00:16.944Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":0,"result":{"protocolVersion":"2024-11-05","capabilities":{"experimental":{},"prompts":{"listChanged":false},"resources":{"subscribe":false,"listChanged":false},"tools":{"listChanged":false}},"serverInfo":{"name":"Bill Processing MCP","version":"1.9.0"}}}
2025-05-19T10:00:16.945Z [Bill Processing MCP] [info] Message from client: {"method":"notifications/initialized","jsonrpc":"2.0"}
2025-05-19T10:00:16.946Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":1}
2025-05-19T10:00:16.947Z [Bill Processing MCP] [info] Message from client: {"method":"tools/list","params":{},"jsonrpc":"2.0","id":2}
2025-05-19T10:00:16.947Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":3}
2025-05-19 15:30:16,943 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 15:30:16,948 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-05-19 15:30:16,948 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T10:00:16.950Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":1,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T10:00:16.951Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"discover_available_bills","description":"\n    Scans the designated uploads directory and lists available bill files.\n    This is the first step for the user to see what can be processed.\n    ","inputSchema":{"properties":{},"title":"discover_available_billsArguments","type":"object"}},{"name":"process_selected_bill_and_ask","description":"\n    Processes a selected bill file from the uploads directory (if not already processed in this session)\n    and then answers a question about it. Stores/updates the bill data.\n    'original_filename' is the name of the file as listed by 'discover_available_bills'.\n    ","inputSchema":{"properties":{"original_filename":{"title":"Original Filename","type":"string"},"question":{"title":"Question","type":"string"}},"required":["original_filename","question"],"title":"process_selected_bill_and_askArguments","type":"object"}},{"name":"list_processed_bills","description":"\n    List all bills currently processed and stored in memory for this session.\n    ","inputSchema":{"properties":{},"title":"list_processed_billsArguments","type":"object"}},{"name":"parse_pdf_bill","description":"\n    (Advanced Use) Parse a PDF file from bytes to extract bill data, store it, and save the PDF.\n    'filename' is a descriptive name for this content.\n    ","inputSchema":{"properties":{"pdf_content":{"format":"binary","title":"Pdf Content","type":"string"},"filename":{"title":"Filename","type":"string"}},"required":["pdf_content","filename"],"title":"parse_pdf_billArguments","type":"object"}},{"name":"parse_image_bill","description":"\n    (Advanced Use) Parse an image file from bytes (e.g., PNG, JPG) to extract bill data.\n    'filename' is a descriptive name. 'image_format' (e.g., 'png') is crucial.\n    ","inputSchema":{"properties":{"image_content":{"format":"binary","title":"Image Content","type":"string"},"filename":{"title":"Filename","type":"string"},"image_format":{"default":"png","title":"Image Format","type":"string"}},"required":["image_content","filename"],"title":"parse_image_billArguments","type":"object"}},{"name":"ask_question_and_save","description":"\n    Ask a question about a specific bill (identified by its ID or original_filename from uploads).\n    The question and answer will be saved to the bill's data and its JSON file.\n    ","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"question":{"title":"Question","type":"string"}},"required":["bill_identifier","question"],"title":"ask_question_and_saveArguments","type":"object"}},{"name":"export_bill_data","description":"Export a bill's data (including Q&A) to a JSON file in the 'exports' directory.","inputSchema":{"properties":{"bill_identifier":{"title":"Bill Identifier","type":"string"},"export_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Export Filename"}},"required":["bill_identifier"],"title":"export_bill_dataArguments","type":"object"}},{"name":"general_chat","description":"Handle general conversation with the user, not specific to any bill.","inputSchema":{"properties":{"message":{"title":"Message","type":"string"}},"required":["message"],"title":"general_chatArguments","type":"object"}}]}}
2025-05-19T10:00:16.951Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":3,"result":{"resources":[]}}
2025-05-19T10:00:16.954Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":4}
2025-05-19 15:30:16,948 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T10:00:16.956Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":4,"result":{"prompts":[]}}
2025-05-19T10:00:32.480Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"discover_available_bills","arguments":{}},"jsonrpc":"2.0","id":5}
2025-05-19 15:30:32,480 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 15:30:32,481 - document_management.api - INFO - Scanning for bills in: C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads
2025-05-19 15:30:32,481 - document_management.api - INFO - Found 3 potential bill files in C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19T10:00:32.483Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\n  \"filename\": \"Amazonbill.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Amazonbill.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Invoice.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Invoice.pdf\",\n  \"status\": \"\"\n}"},{"type":"text","text":"{\n  \"filename\": \"Takeout.pdf\",\n  \"path\": \"C:\\\\Users\\\\user\\\\Desktop\\\\projects\\\\THT_Talentica\\\\assets\\\\bills\\\\uploads\\\\Takeout.pdf\",\n  \"status\": \"\"\n}"}],"isError":false}}
2025-05-19T10:00:38.850Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"process_selected_bill_and_ask","arguments":{"original_filename":"Amazonbill.pdf","question":"What is the total amount billed?"}},"jsonrpc":"2.0","id":6}
2025-05-19 15:30:38,851 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 15:30:38,852 - document_management.api - INFO - Request to process 'Amazonbill.pdf' from uploads and answer question: 'What is the total amount billed?'
2025-05-19 15:30:38,852 - document_management.api - INFO - Bill 'Amazonbill.pdf' not found in memory. Attempting to load and process from C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\uploads.
2025-05-19 15:30:38,852 - document_management.utils - INFO - Internal processing for PDF (original: 'Amazonbill.pdf'), size: 306190 bytes
2025-05-19 15:30:38,852 - document_management.utils - INFO - Copy of PDF 'Amazonbill.pdf' saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\pdfs\Amazonbill.pdf
2025-05-19 15:30:38,865 - document_management.text_extractors - INFO - Extracted raw text length from PDF using pymupdf: 1842
2025-05-19 15:30:38,865 - document_management.utils - INFO - Using model gpt-4o-mini for bill extraction (confidence: 0.8)
2025-05-19 15:30:43,551 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 15:30:43,555 - document_management.utils - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19 15:30:43,555 - document_management.utils - INFO - Successfully parsed and stored PDF as bill ID: bill_1 (from original file: Amazonbill.pdf)
2025-05-19 15:30:43,555 - document_management.api - INFO - Newly processed 'Amazonbill.pdf' assigned bill ID: bill_1
2025-05-19 15:30:43,555 - document_management.api - INFO - Proceeding to answer question for bill 'Amazonbill.pdf' (ID: bill_1).
2025-05-19 15:30:43,556 - document_management.api - INFO - Received question: 'What is the total amount billed?' for bill identifier: 'bill_1'
2025-05-19 15:30:44,350 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 15:30:44,354 - document_management.api - INFO - LLM generated answer for bill bill_1: 'The total amount billed is 1,195.00.'
2025-05-19 15:30:44,355 - document_management.utils - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T10:00:44.357Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"The total amount billed is 1,195.00.\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T10:02:41.191Z [Bill Processing MCP] [info] Message from client: {"method":"tools/call","params":{"name":"ask_question_and_save","arguments":{"bill_identifier":"bill_1","question":"What are the complete details of this bill including invoice date, items purchased, prices, shipping address, and payment method?"}},"jsonrpc":"2.0","id":7}
2025-05-19 15:32:41,193 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
2025-05-19 15:32:41,193 - document_management.api - INFO - Received question: 'What are the complete details of this bill including invoice date, items purchased, prices, shipping address, and payment method?' for bill identifier: 'bill_1'
2025-05-19 15:32:44,908 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
--- Logging error ---
Traceback (most recent call last):
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\logging\__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\u20b9' in position 232: character maps to <undefined>
Call stack:
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\Scripts\mcp.exe\__main__.py", line 10, in <module>
    sys.exit(app())
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\main.py", line 323, in __call__
    return get_command(self)(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\core.py", line 740, in main
    return _main(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\core.py", line 195, in _main
    rv = self.invoke(ctx)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\click\core.py", line 788, in invoke
    return __callback(*args, **kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\typer\main.py", line 698, in wrapper
    return callback(**use_params)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\cli\cli.py", line 362, in run
    server.run(**kwargs)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\server.py", line 232, in run
    anyio.run(self.run_stdio_async)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_core\_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_backends\_asyncio.py", line 2310, in run
    return runner.run(wrapper())
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\anyio\_backends\_asyncio.py", line 217, in run
    return self._loop.run_until_complete(task)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 603, in run_forever
    self._run_once()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 534, in _handle_message
    await self._handle_request(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 568, in _handle_request
    response = await handler(req)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\lowlevel\server.py", line 412, in handler
    results = await func(req.params.name, (req.params.arguments or {}))
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\server.py", line 277, in call_tool
    result = await self._tool_manager.call_tool(name, arguments, context=context)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\tools\tool_manager.py", line 64, in call_tool
    return await tool.run(arguments, context=context)
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\tools\base.py", line 91, in run
    return await self.fn_metadata.call_fn_with_arg_validation(
  File "C:\Users\user\AppData\Local\uv\cache\archive-v0\rYWBFRcVWtnjykJ7tEu5e\lib\site-packages\mcp\server\fastmcp\utilities\func_metadata.py", line 66, in call_fn_with_arg_validation
    return await fn(**arguments_parsed_dict)
  File "C:\Users\user\Desktop\projects\THT_Talentica\server.py", line 257, in ask_question_and_save
    logger.info(f"LLM generated answer for bill {bill.id}: '{answer}'")
Message: "LLM generated answer for bill bill_1: '**Invoice Date:** 28.10.2019  \n**Items Purchased:**\n1. Varasiddhi Silks Men's Formal Shirt (SH-05-42, Navy Blue, 42)  \n   - Price: \u20b9565.00  \n   - Quantity: 1  \n   \n2. Varasiddhi Silks Men's Formal Shirt (SH-05-40, Navy Blue, 40)  \n   - Price: \u20b9565.00  \n   - Quantity: 1  \n\n**Total Amount:** \u20b91,195.00  \n**GST Amount:** \u20b956.88  \n\n**Shipping Address:**  \nMadhu B  \nEurofins IT Solutions India Pvt Ltd  \n1st Floor, Maruti Platinum  \nLakshminarayana Pura, AECS Layout  \nBENGALURU, KARNATAKA, 560037  \nIN  \n\n**Payment Method:** The invoice does not specify a payment method explicitly.'"
Arguments: ()
2025-05-19 15:32:44,913 - document_management.api - INFO - LLM generated answer for bill bill_1: '**Invoice Date:** 28.10.2019  
**Items Purchased:**
1. Varasiddhi Silks Men's Formal Shirt (SH-05-42, Navy Blue, 42)  
   - Price: \u20b9565.00  
   - Quantity: 1  
   
2. Varasiddhi Silks Men's Formal Shirt (SH-05-40, Navy Blue, 40)  
   - Price: \u20b9565.00  
   - Quantity: 1  

**Total Amount:** \u20b91,195.00  
**GST Amount:** \u20b956.88  

**Shipping Address:**  
Madhu B  
Eurofins IT Solutions India Pvt Ltd  
1st Floor, Maruti Platinum  
Lakshminarayana Pura, AECS Layout  
BENGALURU, KARNATAKA, 560037  
IN  

**Payment Method:** The invoice does not specify a payment method explicitly.'
2025-05-19 15:32:45,065 - document_management.utils - INFO - Bill data for bill_1 (file: Amazonbill.pdf) saved to C:\Users\user\Desktop\projects\THT_Talentica\assets\bills\json\bill_1.json
2025-05-19T10:02:45.067Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":7,"result":{"content":[{"type":"text","text":"{\n  \"answer\": \"**Invoice Date:** 28.10.2019  \\n**Items Purchased:**\\n1. Varasiddhi Silks Men's Formal Shirt (SH-05-42, Navy Blue, 42)  \\n   - Price: 565.00  \\n   - Quantity: 1  \\n   \\n2. Varasiddhi Silks Men's Formal Shirt (SH-05-40, Navy Blue, 40)  \\n   - Price: 565.00  \\n   - Quantity: 1  \\n\\n**Total Amount:** 1,195.00  \\n**GST Amount:** 56.88  \\n\\n**Shipping Address:**  \\nMadhu B  \\nEurofins IT Solutions India Pvt Ltd  \\n1st Floor, Maruti Platinum  \\nLakshminarayana Pura, AECS Layout  \\nBENGALURU, KARNATAKA, 560037  \\nIN  \\n\\n**Payment Method:** The invoice does not specify a payment method explicitly.\",\n  \"bill_id\": \"bill_1\"\n}"}],"isError":false}}
2025-05-19T10:10:16.951Z [Bill Processing MCP] [info] Message from client: {"method":"resources/list","params":{},"jsonrpc":"2.0","id":8}
2025-05-19 15:40:16,952 - mcp.server.lowlevel.server - INFO - Processing request of type ListResourcesRequest
2025-05-19T10:10:16.954Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":8,"result":{"resources":[]}}
2025-05-19T10:10:16.954Z [Bill Processing MCP] [info] Message from client: {"method":"prompts/list","params":{},"jsonrpc":"2.0","id":9}
2025-05-19 15:40:16,955 - mcp.server.lowlevel.server - INFO - Processing request of type ListPromptsRequest
2025-05-19T10:10:16.956Z [Bill Processing MCP] [info] Message from server: {"jsonrpc":"2.0","id":9,"result":{"prompts":[]}}
